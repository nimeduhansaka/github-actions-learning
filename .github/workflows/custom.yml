name: Custom CI

on:
  push:
    branches: ["main"]
  pull_request:
    branches: ["main"]
  workflow_dispatch:
    inputs:
      trigger_reason:
        description: "Reason for running this workflow manually"
        required: true
        default: "Manual testing"

jobs:
  build-and-test:
    name: Build & Test App
    runs-on: ubuntu-latest

    defaults:
      run:
        working-directory: ./sample-app

    steps:
      - name: ğŸš€ Start CI Pipeline
        run: echo "Starting CI pipeline triggered by ${{ inputs.trigger_reason || 'Push/PR event' }}..."

      - name: ğŸ’» Print Runner Details
        run: |
          echo "Running on OS: ${{ runner.os }}"
          echo "Node Version: 18 (Planned)"

      - name: ğŸ“¥ Checkout code
        uses: actions/checkout@v3

      - name: âš™ï¸ Set up Node.js
        uses: actions/setup-node@v3
        with:
          node-version: "18"
          cache: "npm"
          cache-dependency-path: sample-app/package-lock.json

      - name: ğŸ“¦ Install dependencies
        run: |
          echo "Installing dependencies..."
          npm ci

      - name: ğŸ§ª Run tests
        run: |
          echo "Running test suite..."
          npm test

      - name: âœ… Completion
        if: success()
        run: echo "Build and tests passed successfully! ğŸ‰"
